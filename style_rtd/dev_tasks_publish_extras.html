
<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Develop a Task to Publish &quot;Extra&quot; Artifacts</title>

  <link rel="shortcut icon" href="../_static/pants-logo.ico"/>

  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'0.1',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
  </script>

  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <script type="text/javascript" src="../_static/js/theme.js"></script>


<script type="text/javascript">
  // In a plain template, we'd put this in the footer block.
  // In the read-the-docs template, there is no footer. So use jQuery ready:
  $(document).ready(function() {
    // Ping Google analytics
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-39101739-2', 'auto');
    ga('send', 'pageview');

    // Show the travis-ci status graphic
    $('.wy-breadcrumbs').append(
      '<div style="float: right;">' +
      '<a href="https://travis-ci.org/pantsbuild/pants">' +
      '<img src="https://travis-ci.org/pantsbuild/pants.png?branch=master">' +
      '</a></div>');
  });
</script>
<style type="text/css">
/* Shoehorn in pants logo */
body .icon-home:before {
   content: "";
}

body .icon-home{
  background: transparent url(../_static/pants-logo.ico) center left no-repeat;
  background-position-x: 5px;
  padding-left: 40px;
  padding-right: 35px;
  line-height: 40px;
}

body a.icon-home:hover{
  background: #3d8cbf url(../_static/pants-logo.ico) center left no-repeat;
  background-position-x: 5px;
}

</style>

<script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="icon icon-home"> pants</a>

  <form class="wy-form" action="https://www.google.com/search">
  <input name="as_q" class="query" placeholder="Search">
  <input name="as_sitesearch" value="pantsbuild.github.io" type="hidden">
<!--  <input value="Search" type=submit class="button"> -->
  </form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">


<ul>
<li class="toctree-l1 ">
<a href="first_concepts.html">Pants Conceptual Overview</a>
</li>
<li class="toctree-l1 ">
<a href="first_tutorial.html">First Tutorial</a>
</li>
<li class="toctree-l1 ">
<a href="target_addresses.html">Target Addresses</a>
</li>
<li class="toctree-l1 ">
<a href="JVMProjects.html">JVM Projects with Pants</a>
</li>
<li class="toctree-l2 ">
<a href="3rdparty_jvm.html">JVM 3rdparty Pattern</a>
</li>
<li class="toctree-l2 ">
<a href="from_maven.html">Pants for Maven Experts</a>
</li>
<li class="toctree-l1 ">
<a href="python-readme.html">Python Projects with Pants</a>
</li>
<li class="toctree-l2 ">
<a href="3rdparty_py.html">Python 3rdparty Pattern</a>
</li>
<li class="toctree-l2 ">
<a href="pex_design.html">PEX Design</a>
</li>
<li class="toctree-l2 ">
<a href="python_old.html">Using Pants for Python development, 2014 and Earlier</a>
</li>
<li class="toctree-l1 ">
<a href="page.html">README Files and Markdown</a>
</li>
<li class="toctree-l1 ">
<a href="build_files.html">BUILD files</a>
</li>
<li class="toctree-l1 ">
<a href="invoking.html">Invoking Pants Build</a>
</li>
<li class="toctree-l1 ">
<a href="tshoot.html">Troubleshooting</a>
</li>
<li class="toctree-l1 ">
<a href="3rdparty.html">Third-Party Dependencies</a>
</li>
<li class="toctree-l2 ">
<a href="3rdparty_jvm.html">JVM 3rdparty Pattern</a>
</li>
<li class="toctree-l2 ">
<a href="3rdparty_py.html">Python 3rdparty Pattern</a>
</li>
<li class="toctree-l1 ">
<a href="ThriftDeps.html">Using Pants with Thrift Dependencies</a>
</li>
<li class="toctree-l1 ">
<a href="publish.html">Publishing Artifacts</a>
</li>
<li class="toctree-l1 ">
<a href="with_emacs.html">Emacs With Pants</a>
</li>
<li class="toctree-l1 ">
<a href="with_intellij.html">Using Pants with IntelliJ IDEA</a>
</li>
<li class="toctree-l1 ">
<a href="install.html">Installing Pants</a>
</li>
<li class="toctree-l1 ">
<a href="setup_repo.html">Set up Your Source Tree for Pants</a>
</li>
<li class="toctree-l1 ">
<a href="build_dictionary.html">Pants BUILD Dictionary</a>
</li>
<li class="toctree-l1 ">
<a href="goals_reference.html">Pants Goals Reference</a>
</li>
<li class="toctree-l1 ">
<a href="dev.html">Pants Developer Center</a>
</li>
<li class="toctree-l2 ">
<a href="howto_contribute.html">Pants Contributors Guide</a>
</li>
<li class="toctree-l2 ">
<a href="howto_ask.html">How To Ask</a>
</li>
<li class="toctree-l2 ">
<a href="howto_develop.html">Pants Developers Guide</a>
</li>
<li class="toctree-l2 ">
<a href="dev_tasks.html">Task Developer's Guide</a>
</li>
<li class="toctree-l3 current">
Develop a Task to Publish &quot;Extra&quot; Artifacts
</li>
<li class="toctree-l2 ">
<a href="howto_plugin.html">Developing a Pants Plugin</a>
</li>
<li class="toctree-l2 ">
<a href="intellij.html">Pants Development with IntelliJ IDEA</a>
</li>
<li class="toctree-l2 ">
<a href="internals.html">Pants Internals</a>
</li>
<li class="toctree-l2 ">
<a href="release.html">Release Process</a>
</li>
<li class="toctree-l2 ">
<a href="docs.html">About the documentation</a>
</li>
<li class="toctree-l2 ">
<a href="credits.html">Credits</a>
</li>
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">pants</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
<li><a href="index.html">Welcome to the Pants build system.</a>
<li><a href="dev.html">Pants Developer Center</a>
<li><a href="dev_tasks.html">Task Developer's Guide</a>
<li><a href="dev_tasks_publish_extras.html">Develop a Task to Publish &quot;Extra&quot; Artifacts</a>
</ul>



<div class="section">
<!-- main content start -->
<!-- generated by pants! -->
<style>
.codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f0f0f0; }
.codehilite .c { color: #60a0b0; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #007020; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #007020 } /* Comment.Preproc */
.codehilite .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #808080 } /* Generic.Output */
.codehilite .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0040D0 } /* Generic.Traceback */
.codehilite .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #007020 } /* Keyword.Pseudo */
.codehilite .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #902000 } /* Keyword.Type */
.codehilite .m { color: #40a070 } /* Literal.Number */
.codehilite .s { color: #4070a0 } /* Literal.String */
.codehilite .na { color: #4070a0 } /* Name.Attribute */
.codehilite .nb { color: #007020 } /* Name.Builtin */
.codehilite .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.codehilite .no { color: #60add5 } /* Name.Constant */
.codehilite .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.codehilite .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #007020 } /* Name.Exception */
.codehilite .nf { color: #06287e } /* Name.Function */
.codehilite .nl { color: #002070; font-weight: bold } /* Name.Label */
.codehilite .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #062873; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #bb60d5 } /* Name.Variable */
.codehilite .ow { color: #007020; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mf { color: #40a070 } /* Literal.Number.Float */
.codehilite .mh { color: #40a070 } /* Literal.Number.Hex */
.codehilite .mi { color: #40a070 } /* Literal.Number.Integer */
.codehilite .mo { color: #40a070 } /* Literal.Number.Oct */
.codehilite .sb { color: #4070a0 } /* Literal.String.Backtick */
.codehilite .sc { color: #4070a0 } /* Literal.String.Char */
.codehilite .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #4070a0 } /* Literal.String.Double */
.codehilite .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #4070a0 } /* Literal.String.Heredoc */
.codehilite .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.codehilite .sx { color: #c65d09 } /* Literal.String.Other */
.codehilite .sr { color: #235388 } /* Literal.String.Regex */
.codehilite .s1 { color: #4070a0 } /* Literal.String.Single */
.codehilite .ss { color: #517918 } /* Literal.String.Symbol */
.codehilite .bp { color: #007020 } /* Name.Builtin.Pseudo */
.codehilite .vc { color: #bb60d5 } /* Name.Variable.Class */
.codehilite .vg { color: #bb60d5 } /* Name.Variable.Global */
.codehilite .vi { color: #bb60d5 } /* Name.Variable.Instance */
.codehilite .il { color: #40a070 } /* Literal.Number.Integer.Long */
</style>

<table class="h-plus-pilcrow">
<tbody>
<tr>
<td class="h-plus-pilcrow-holder"><h1 id="develop-a-task-to-publish-extra-artifacts">Develop a Task to Publish "Extra" Artifacts</h1></td>
<td><div class="pilcrow-div">
<a class="pilcrow-link" href="#develop-a-task-to-publish-extra-artifacts">¶</a>
</div></td>
</tr>
</tbody>
</table>

<p>Pants supports "publish plugins", which allow end-users to add
additional, arbitrary files to be published along with the primary
artifact. For example, let's say that along with publishing your jar
full of class files, you would also like to publish a companion file
that contains some metadata -- code coverage info, source git
repository, java version that created the jar, etc. To accomplish this,
you'll first need to write a custom task, which creates any additional
files (jar or otherwise) that you would like to publish. Next, you'll
create a <code>publish_extras</code> section under <code>[jar-publish]</code> in pants.ini,
and add a key for the new product type. Your custom task will create the
extra file(s) that you want to publish, and write the path to the
products map under the key that you have defined in pants.ini. The
publishing code will loop over all keys found in pants.ini, and consult
the product map. If pants finds a file for the current key, it will
gather it up, and bundle it in with the rest of the files being
published.</p>
<p>An example of a custom task is supplied in the
<code>examples/src/python/example/pants_publish_plugin</code> directory. To use it,
add the following to your pants.ini:</p>
<div class="codehilite"><pre>[jar-publish]
publish_extras: {
    'extra_test_jar_example': {
      'override_name': '{target_provides_name}-extra_example',
      'classifier': 'classy',
      'extension': 'jar',
    },
  }

[backends]
packages: [
    'example.pants_publish_plugin',
  ]
</pre></div>
<p>In the above configuration example, the string
<code>'extra_test_jar_example'</code> is a key into the product map. In this case,
the example task will add additional files for publishing to the product
map under this key. And <code>jar_publish.py</code> will examine the product map,
looking for all keys defined here, and publishing any additional files
found.</p>

<table class="h-plus-pilcrow">
<tbody>
<tr>
<td class="h-plus-pilcrow-holder"><h2 id="constructing-a-name-for-your-extra-artifact">Constructing a name for your extra artifact:</h2></td>
<td><div class="pilcrow-div">
<a class="pilcrow-link" href="#constructing-a-name-for-your-extra-artifact">¶</a>
</div></td>
</tr>
</tbody>
</table>

<p>By default, pants uses the following scheme when publishing artifacts:</p>
<div class="codehilite"><pre>[artifactId]-[version](-[classifier]).[ext]
</pre></div>
<p>The pants plugin publishing system allows a customization of the
artifact identifier, classifier, and file extension. To customize the
name of your extra object, you can supply some extra parameters in the
<code>pants.ini</code> file:</p>
<ul>
<li><code>override_name</code> -- allows customization of the name (<code>artifactId</code>)
    of the additional file published. Specifying a string will
    completely override the name, or include
    '<code>{target_provides_name}</code>' to tack an addition on to the
    pre-existing artifact name. Defaults to the pre-existing artifact
    name.</li>
<li><code>classifier</code> -- the maven classifier. Can be any arbitrary string,
    or leave this unspecified for nothing.</li>
<li><code>extension</code> -- the filename extension. Defaults to "jar".</li>
</ul>
<p><strong>Note:</strong> You must supply a non-default value for at least one of the
above parameters, otherwise your extra publish artifact won't have a
unique name. With the above config in your pants.ini, invoke pants like
this, to do a test publish:</p>
<div class="codehilite"><pre><span class="nv">WRAPPER_SRCPATH</span><span class="o">=</span>examples/src/python <span class="nv">PANTS_DEV</span><span class="o">=</span>1 ./pants goal publish examples/src/java/com/pants/examples/hello/greet --no-dryrun --local<span class="o">=</span>~/tmp
</pre></div>
<p>Now if you examine the <code>/tmp</code> directory, you'll notice that an extra jar
has been published for the <code>greet</code> target:</p>
<div class="codehilite"><pre><span class="nv">$ </span>ls -1 /tmp/com/pants/examples/hello-greet/0.0.1-SNAPSHOT/|grep example
hello-greet-extra_example-0.0.1-SNAPSHOT-classy.jar
hello-greet-extra_example-0.0.1-SNAPSHOT-classy.jar.md5
hello-greet-extra_example-0.0.1-SNAPSHOT-classy.jar.sha1
</pre></div>
<p>This example task should provide a rough starting guide, and can be
tailored to suit a more specific situation.</p>

<!-- main content end -->
</div>

         <footer>
  
    <div class="rst-footer-buttons">
  <hr/>

  <p>
      &copy; Copyright, Pants project contributors.<br>
      Generated by <a href="http://pantsbuild.github.io/docs.html">publish_docs</a> dist/markdown/html/src/python/pants/docs/dev_tasks_publish_extras.html 2014-12-07T16:14:07.568719
  </p>

  Theme provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>
   </section>

  </div>
  

</body>
</html>
